- name: Update the system
  become: true
  community.general.pacman:
    update_cache: true
    upgrade: true

- name: Install required packages
  become: true
  community.general.pacman:
    name: "{{ item }}"
    state: present
  loop:
    - ansible
    - python

# Install yay AUR helper
- name: Install yay AUR helper
  become: true
  become_user: "{{ ansible_user }}"
  ansible.builtin.shell: |
    sudo pacman -S --needed git base-devel
    git clone https://aur.archlinux.org/yay.git
    cd yay
    makepkg -si --noconfirm
  args:
    creates: "/usr/bin/yay"
