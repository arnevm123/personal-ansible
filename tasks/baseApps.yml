- name: Install packages
  become: true
  ansible.builtin.dnf:
    name: ["tmux", "fzf", "neovim", "gimp", "tldr", "ripgrep", "htop", "lsof", "shutter"]
  tags:
    - install
    - productivity

- name: Install languages
  become: true
  ansible.builtin.dnf:
    name: ["nodejs", "npm", "dnf", "go", "shellcheck", "luarocks", "g++", "make", "ansible-lint", "python3-pip"]
  tags:
    - install
    - productivity
    - languages

# - name: Rust likes to be special
#   become: true
#   ansible.builtin.command: /bin/bash -o pipefail -c "curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -y"
#   args:
#     creates: /usr/local/bin/cargo
#   tags:
#     - install
#     - productivity
#     - languages
# - name: Install Deno
#   become: true
#   ansible.builtin.command: /bin/bash -o pipefail -c "curl -fsSL https://deno.land/x/install/install.sh | sh"
#   args:
#     creates: /usr/local/bin/deno
#   tags:
#     - install
#     - productivity
#     - languages

- name: Check if deno is installed
  changed_when: false
  ansible.builtin.command: -v deno
  register: deno_exists
  ignore_errors: true
  tags:
    - install
    - productivity
    - languages

- name: Download Installer
  when: deno_exists is failed
  ansible.builtin.get_url:
    url: https://deno.land/x/install/install.sh
    dest: /tmp/sh.deno.rs
    mode: '0755'
    force: 'yes'
  tags:
    - deno
    - install
    - productivity
    - languages

- name: Install deno
  when: deno_exists is failed
  changed_when: false
  ansible.builtin.command: /tmp/sh.deno.rs
  tags:
    - deno
    - install
    - productivity
    - languages

- name: Check if cargo is installed
  changed_when: false
  ansible.builtin.command: -v cargo
  register: cargo_exists
  ignore_errors: true
  tags:
    - install
    - productivity
    - languages

- name: Download Installer
  when: cargo_exists is failed
  ansible.builtin.get_url:
    url: https://sh.rustup.rs
    dest: /tmp/sh.rustup.rs
    mode: '0755'
    force: 'yes'
  tags:
    - rust
    - install
    - productivity
    - languages

- name: Install rust/cargo
  when: cargo_exists is failed
  changed_when: false
  ansible.builtin.command: /tmp/sh.rustup.rs -y
  tags:
    - rust
    - install
    - productivity
    - languages
